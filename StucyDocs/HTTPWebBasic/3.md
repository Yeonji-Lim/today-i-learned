# HTTP(HyperText Transfer Protocol)

## 모든 것이 HTTP
HTML, TEXT, IMAGE, 음성, 영상, 파일, JSON, XML (API)

거의 모든 형태의 데이터 전송 가능  

서버간에 데이터를 주고 받을 때도 대부분 HTTP 사용 지금은 HTTP 시대!

특수한 경우에만 다른 프로토콜을 사용하고 있다. 

## HTTP 역사
- HTTP/0.9 1991년: GET 메서드만 지원, HTTP 헤더X
- HTTP/1.0 1996년: 메서드, 헤더 추가
- **HTTP/1.1 1997년: 가장 많이 사용, 우리에게 가장 중요한 버전**
	- RFC2068 (1997) -> RFC2616 (1999) -> RFC7230~7235 (2014) : 계속 개정됨
- HTTP/2 2015년: 성능 개선
- HTTP/3 진행중: TCP 대신에 UDP 사용, 성능 개선

## 기반 프로토콜

- TCP: HTTP/1.1, HTTP/2
- UDP: HTTP/3
	- TCP는 안정적이지만 3way handshake도 해야하고, 데이터가 너무 많음, 기본적으로 매커니즘 자체가 빠른 프로토콜이 아님
	- UDP를 쓰고 애플리케이션 계층에서 성능을 최적화해서 등장한 것이 http3
- 현재 HTTP/1.1 주로 사용
	- HTTP/2, HTTP/3 도 점점 증가

## 특징

### 클라이언트 서버 구조

- Request Response 구조  
- 클라이언트는 서버에 요청을 보내고, 응답을 대기 
- 서버가 요청에 대한 결과를 만들어서 응답

**클라이언트와 서버가 분리되었다**라는 점이 중요한 것

비즈니스 로직은 다 서버에서, UI/UX는 다 클라이언트에서 신경쓸 수 있다.

### 무상태 프로토콜 : 스테이트리스(Stateless)

- 서버가 클라이언트의 상태를 보존X 
- 장점: 서버 확장성 높음(스케일 아웃) 
- 단점: 클라이언트가 추가 데이터 전송

#### Stateful
항상 같은 서버가 유지 되어야 한다.

#### Stateless
응답 서버를 쉽게 바꿀 수 있다. : 무한한 서버의 증설이 가능하다.

스케일 아웃! 수평 확장에 유리하다.

#### Stateless 한계
- 무상태로 설계할 수 없는 경우도 있다.
  로그인 같은 경우 상태를 유지해야 함
- 상태 유지는 최소한만 사용. 최대한 무상태로 설계한다.
- 데이터를 많이 보내야 함

### 비연결성(connectionless)

- HTTP는 기본이 연결을 유지하지 않는 모델
- 일반적으로 초 단위의 이하의 빠른 속도로 응답
	- 1시간 동안 수천명이 서비스를 사용해도 실제 서버에서 동시에 처리하는 요청은 수십개 이하로 매우 작음
		- 예) 웹 브라우저에서 계속 연속해서 검색 버튼을 누르지는 않는다. 
- 서버 자원을 매우 효율적으로 사용할 수 있음

#### 한계와 극복

- TCP/IP 연결을 새로 맺어야 함 - 3 way handshake 시간 추가  
- 웹 브라우저로 사이트를 요청하면 HTML 뿐만 아니라 자바스크립트, css, 추가 이미지 등 수 많은 자원이 함께 다운로드  
- 지금은 HTTP 지속 연결(Persistent Connections)로 문제 해결 
- HTTP/2, HTTP/3에서 더 많은 최적화

## 스테이트리스를 기억하자

가장 어려운 문제 : 동시에 대용량 트래픽이 발생하는 경우

이런 경우가 있다고 하더라도 최대한 스테이트리스로 설계를 하는 것이 중요하다.

## HTTP 메시지

### 구조
```
start line
header
empty line
message body
```

### start line - 요청 메시지
- HTTP 메서드
- 요청 대상
- HTTP version
 
### start line - 응답 메시지
- HTTP version
- HTTP status
- 이유 문구: 사람이 이해할 수 있는 짧은 상태 코드 설명 글

### header
```
header-field = field-name ":" OWS field-value OWS
```
(OWS:띄어쓰기 허용)

- field-name : 대소문자 구분 x

#### header 용도

- HTTP 전송에 필요한 모든 부가정보

  -> 메시지 바디 뺴고 필요한 메타정보가 다 들어있다.
  
  예) 메시지 바디의 내용, 메시지 바디의 크기, 압축, 인증, 요청 클라이언트(브라우저) 정보, 서버 애플리케이션 정보, 캐시 관리 정보...

- 표준 헤더가 너무 많다.
- 필요시 임의의 헤더 추가 가능

### message body
- 실제 전송할 데이터
- byte로 표현 가능한 모든 데이터 전송 가능

## 단순하고 확장 가능하다.
크게 성공하는 표준 기술은 단순하지만 확장 가능하다.