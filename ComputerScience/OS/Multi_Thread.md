# 멀티 스레드

[CPU](CPU)의 최대활용을 위해 스레드 둘 이상을 동시에 실행

[Context Switching](Context Switching)을 통해 이뤄짐 : 부분적으로 조금씩 스레드에 대한 작업이 끝난다.

근데 이 과정이 엄청 빠르게 진행 -> 마치 동시에 실행되는 것 같음

ex : 웹 브라우저에서 블로그 쓰기와 음악 듣기를 동시에 수행 가능

웹 서버는 대표적인 멀티 스레드 응용 프로그램이다.

## 장점

### [프로세스](Process) 보다 가벼움
[스레드](Thread)
- 프로세스 내에서 생성
- 생성과 종료가 간단, 빠름
- 코드, 데이터, 스택 영역을 제외한 나머지 자원 서로 공유 -> 기본 내장 데이터 용량이 프로세스보다 적음 

### 응답성
stack을 제외한 [메모리](Memory)를 공유 : 응답시간이 빨라짐

멀티 스레드 모델은 에러 발생시 새로운 스레드를 생성해서 극복

다만, 새로운 스레드 생성이나 놀고 있는 스레드 처리에 비용 발생

ex : 웹 브라우저에서 하나의 스레드가 이미지 파일을 로드하는 동안 다른 스레드에서 사용자와 상호작용 가능

(싱글 스레드의 경우에는 프로그램 일부분이 중단되거나 에러 발생시 바로 프로그램이 멈춤)

### 경제성
stack을 제외한 프로세스 내 자원들과 메모리를 공유 : 메모리 공간과 시스템 자원 소모가 줄어든다. 

스레드간 통신시 쉽게 데이터 주고 받음 

### Context Switching  비용 감소

프로세스에서의 context switching과 달리 스레드 간의 context switching은 캐시 메모리를 비울 필요가 없기 때문에 빠르다. 

	프로세스 간에서는 공유하는 데이터가 없기 때문에 컨텍스트 스위칭이 일어나면 새로 캐시정보를 쌓아야 함 이것이 프로세스 간 컨텍스트 스위칭에 부담이 되는 요소

공유하는 자원을 제외한 스레드 정보(stack, register)만을 교체하면 된다.

`그렇지만 그래도 overhead가 있기 때문에 스레드가 마냥 많다고 좋은 것은 아니다.`
### 멀티프로세서의 활용
다중 CPU 구조에서는 각각의 스레드가 다른 프로세서에서 병렬로 수행될 수 있으므로 병렬성이 증가 

## 단점

### 안정성
하나의 스레드에서의 문제가 다른 스레드에 영향을 받음
-> 프로그래머의 역량에 따라 극복 가능 : 스레드에 에러 발생시 적절한 예외 처리
	에러 발생 시 새로운 스레드를 생성하거나 스레드 풀에서 잔여 스레드를 가져오던지 해서 프로그램 종료 방지

### 동기화로 인한 성능 저하
공유자원에 동시 접근 -> 동기화 문제 발생 가능
"스레드 간 동기화" : 데이터 접근 제어를 위한 필수 기술

동기화 작업 : 여러 스레드들이 자원에 대한 접근을 순차적으로 통제
-> 동시 수정은 일어나지 않지만 병목 현상이 일어나 성능 저하 가능성이 높음